### **MÃ´ Táº£ Chi Tiáº¿t: NÃ¢ng Cáº¥p Trang Quáº£n LÃ½ TÃ i Khoáº£n**

**Má»¥c tiÃªu tá»•ng thá»ƒ:**Â TÃ¡i thiáº¿t káº¿ trang Quáº£n lÃ½ tÃ i khoáº£n Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng tin má»™t cÃ¡ch toÃ n diá»‡n, phÃ¢n cáº¥p rÃµ rÃ ng, Ä‘á»“ng thá»i mang láº¡i má»™t tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng hiá»‡n Ä‘áº¡i, chuyÃªn nghiá»‡p vÃ  dá»… dÃ ng cho viá»‡c chá»‰nh sá»­a.

### **Háº¡ng Má»¥c 1: Cáº£i Tiáº¿n Bá»‘ Cá»¥c & Giao Diá»‡n Tá»•ng Thá»ƒ**

**Task 1.1: Ãp dá»¥ng Bá»‘ cá»¥c 2 Cá»™t Linh Hoáº¡t**

- **Má»¥c tiÃªu:**Â Thay tháº¿ layout má»™t cá»™t hiá»‡n táº¡i báº±ng layout hai cá»™t Ä‘á»ƒ phÃ¢n tÃ¡ch thÃ´ng tin cÃ¡ nhÃ¢n vÃ  thÃ´ng tin tá»• chá»©c/báº£o máº­t.
- **YÃªu cáº§u vá» Bá»‘ cá»¥c:**
    - Sá»­ dá»¥ng CSS Grid Ä‘á»ƒ táº¡o layout 2 cá»™t trÃªn cÃ¡c mÃ n hÃ¬nh lá»›n (md:grid-cols-3):
        - **Cá»™t BÃªn TrÃ¡i (1/3 chiá»u rá»™ng):**Â Sáº½ lÃ  khu vá»±c hiá»ƒn thá»‹ Avatar, TÃªn, Vai trÃ² vÃ  má»™t menu Ä‘iá»u hÆ°á»›ng phá»¥.
        - **Cá»™t BÃªn Pháº£i (2/3 chiá»u rá»™ng):**Â Sáº½ lÃ  khu vá»±c ná»™i dung chÃ­nh, chá»©a cÃ¡c form vÃ  thÃ´ng tin chi tiáº¿t.

### **Háº¡ng Má»¥c 2: Thiáº¿t Káº¿ Láº¡i Cá»™t BÃªn TrÃ¡i - "Há»“ SÆ¡ Nhanh" & Äiá»u HÆ°á»›ng Phá»¥**

**Task 2.1: XÃ¢y Dá»±ng ComponentÂ ProfileSidebar.tsx**

- **File cáº§n táº¡o:**Â src/components/features/account/ProfileSidebar.tsx.
- **Má»¥c tiÃªu:**Â Táº¡o ra má»™t tháº» thÃ´ng tin cÃ¡ nhÃ¢n trá»±c quan vÃ  má»™t menu Ä‘iá»u hÆ°á»›ng cho cÃ¡c má»¥c trong trang tÃ i khoáº£n.
- **YÃªu cáº§u vá» Giao diá»‡n:**
    1. **ComponentÂ <Card>Â lÃ m khung chÃ­nh.**
    2. **Khu vá»±c Avatar & TÃªn:**
        - Má»™t componentÂ <Avatar>Â lá»›n á»Ÿ trÃªn cÃ¹ng.
        - BÃªn dÆ°á»›i lÃ Â **Há» vÃ  TÃªn**Â (full_nameÂ tá»« báº£ngÂ profiles) - chá»¯ lá»›n,Â font-bold.
        - Email (emailÂ tá»« báº£ngÂ auth.users) - chá»¯ nhá» hÆ¡n,Â text-secondary.
    3. **Khu vá»±c Vai trÃ² & Tá»• chá»©c:**
        - Hiá»ƒn thá»‹Â **Vai trÃ²**Â (roleÂ tá»«Â profiles) dÆ°á»›i dáº¡ng má»™tÂ <Badge>. VÃ­ dá»¥:Â Dispatcher.
        - Hiá»ƒn thá»‹Â **TÃªn CÃ´ng ty/Tá»• chá»©c**Â (nameÂ tá»« báº£ngÂ organizationsÂ qua join).
    4. **Menu Äiá»u hÆ°á»›ng Phá»¥:**
        - Má»™t danh sÃ¡ch cÃ¡c nÃºtÂ <Button variant="ghost">Â cÄƒn trÃ¡i, chiáº¿m toÃ n bá»™ chiá»u rá»™ng.
        - Má»—i nÃºt lÃ  má»™t link hoáº·c sáº½ Ä‘iá»u khiá»ƒn viá»‡c hiá»ƒn thá»‹ component á»Ÿ cá»™t bÃªn pháº£i.
        - CÃ¡c má»¥c menu:
            - ğŸ‘¤ Há»“ sÆ¡Â (Máº·c Ä‘á»‹nh Ä‘Æ°á»£c chá»n)
            - ğŸ¢ ThÃ´ng tin Tá»• chá»©c
            - ğŸ”’ Báº£o máº­t & ÄÄƒng nháº­p

---

### **Háº¡ng Má»¥c 3: Thiáº¿t Káº¿ Láº¡i Cá»™t BÃªn Pháº£i - Ná»™i Dung Chi Tiáº¿t (Äiá»u khiá»ƒn bá»Ÿi Menu Phá»¥)**

**Má»¥c tiÃªu:**Â Hiá»ƒn thá»‹ ná»™i dung tÆ°Æ¡ng á»©ng vá»›i má»¥c Ä‘Æ°á»£c chá»n á»Ÿ menu cá»™t trÃ¡i.

**Task 3.1: ComponentÂ AccountDetails.tsxÂ (TÆ°Æ¡ng á»©ng vá»›i má»¥c "Há»“ sÆ¡")**

- **Thiáº¿t káº¿:**
    - Má»™tÂ <Card>Â lá»›n chá»©a ná»™i dung.
    - <CardHeader>: TiÃªu Ä‘á» "ThÃ´ng tin cÃ¡ nhÃ¢n".
    - <CardContent>: Form cho phÃ©p chá»‰nh sá»­a cÃ¡c trÆ°á»ng:
        - **Há» vÃ  TÃªn (full_name):**Â <Input>Â cÃ³ sáºµn giÃ¡ trá»‹.
        - **Sá»‘ Ä‘iá»‡n thoáº¡i (phone_numberÂ tá»«Â profilesÂ - Cáº¦N THÃŠM VÃ€O SCHEMA):**Â <Input>. ÄÃ¢y lÃ  thÃ´ng tin cÃ¡ nhÃ¢n nÃªn thuá»™c vá» profile.
        - **Avatar:**Â Component táº£i áº£nh lÃªn Ä‘á»ƒ ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ thay Ä‘á»•i áº£nh Ä‘áº¡i diá»‡n.
- **HÃ nh Ä‘á»™ng:**Â NÃºt "LÆ°u thay Ä‘á»•i".

**Task 3.2: ComponentÂ OrganizationDetails.tsxÂ (TÆ°Æ¡ng á»©ng vá»›i má»¥c "ThÃ´ng tin Tá»• chá»©c")**

- **Thiáº¿t káº¿:**
    - <CardHeader>: TiÃªu Ä‘á» "ThÃ´ng tin Tá»• chá»©c".
    - <CardContent>: Hiá»ƒn thá»‹ thÃ´ng tin cá»§a tá»• chá»©c mÃ  ngÆ°á»i dÃ¹ng thuá»™c vá».Â **Táº¥t cáº£ cÃ¡c trÆ°á»ng Ä‘á»u lÃ  chá»‰ Ä‘á»c (read-only) cho vai trÃ² Dispatcher.**
        - **TÃªn CÃ´ng ty/Tá»• chá»©c (name):**Â Hiá»ƒn thá»‹ dáº¡ng text.
        - **MÃ£ sá»‘ thuáº¿ (tax_code):**Â Hiá»ƒn thá»‹ dáº¡ng text.
        - **Äá»‹a chá»‰ trá»¥ sá»Ÿ (address):**Â Hiá»ƒn thá»‹ dáº¡ng text.
        - **Sá»‘ Ä‘iá»‡n thoáº¡i cÃ´ng ty (phone_number):**Â Hiá»ƒn thá»‹ dáº¡ng text.
        - **Tráº¡ng thÃ¡i (status):**Â Hiá»ƒn thá»‹ dÆ°á»›i dáº¡ngÂ <Badge>Â (vÃ­ dá»¥:Â ACTIVE).
- **Ghi chÃº:**Â CÃ³ má»™t dÃ²ng ghi chÃº:Â *"ThÃ´ng tin nÃ y chá»‰ cÃ³ thá»ƒ Ä‘Æ°á»£c thay Ä‘á»•i bá»Ÿi ngÆ°á»i quáº£n trá»‹ cá»§a tá»• chá»©c hoáº·c Admin há»‡ thá»‘ng."*

**Task 3.3: ComponentÂ SecuritySettings.tsxÂ (TÆ°Æ¡ng á»©ng vá»›i má»¥c "Báº£o máº­t & ÄÄƒng nháº­p")**

- **Thiáº¿t káº¿:**
    - **Khu vá»±c 1: Äá»•i Máº­t kháº©u:**
        - <CardHeader>: "Thay Ä‘á»•i máº­t kháº©u".
        - <CardContent>: Form chá»©a 3 Ã´: Máº­t kháº©u hiá»‡n táº¡i, Máº­t kháº©u má»›i, XÃ¡c nháº­n máº­t kháº©u má»›i.
    - **Khu vá»±c 2 (NÃ¢ng cao): TÃ¹y chá»n ÄÄƒng nháº­p eDepot:**
        - <CardHeader>: "LiÃªn káº¿t tÃ i khoáº£n".
        - <CardContent>:
            - Hiá»ƒn thá»‹ tráº¡ng thÃ¡i liÃªn káº¿t:
                - **Náº¿uÂ edepot_usernameÂ Ä‘Ã£ cÃ³ giÃ¡ trá»‹:**Â Hiá»ƒn thá»‹Â âœ… ÄÃ£ liÃªn káº¿t vá»›i tÃ i khoáº£n eDepot: [edepot_username]. KÃ¨m nÃºt "Há»§y liÃªn káº¿t".
                - **Náº¿uÂ edepot_usernameÂ lÃ Â NULL:**Â Hiá»ƒn thá»‹ má»™t nÃºtÂ LiÃªn káº¿t vá»›i tÃ i khoáº£n eDepot, khi nháº¥n sáº½ má»Ÿ ra má»™t quy trÃ¬nh Ä‘á»ƒ ngÆ°á»i dÃ¹ng nháº­p user/pass eDepot vÃ  xÃ¡c thá»±c.

---

### **Háº¡ng Má»¥c 4: Cáº­p Nháº­t CSDL & Logic Backend**

**Task 4.1: Cáº­p nháº­t Schema CSDL (náº¿u cáº§n)**

- **YÃªu cáº§u (SQL):**codeSQL
    
    ```
    -- ThÃªm cá»™t sá»‘ Ä‘iá»‡n thoáº¡i vÃ  avatar vÃ o báº£ng profiles
    ALTER TABLE public.profiles
    ADD COLUMN phone_number TEXT,
    ADD COLUMN avatar_url TEXT;
    ```
    

**Task 4.2: Cáº­p Nháº­t Logic Fetch Dá»¯ Liá»‡u TrangÂ account/page.tsx**

- **YÃªu cáº§u:**Â Trang nÃ y cáº§n pháº£i fetch dá»¯ liá»‡u tá»« nhiá»u báº£ng vÃ Â JOINÂ chÃºng láº¡i.
- **CÃ¢u lá»‡nh Supabase gá»£i Ã½ (trong Server Component):**codeTypeScript
    
    ```
    const { data: { user } } = await supabase.auth.getUser();
    
    // Láº¥y profile vÃ  JOIN vá»›i organization
    const { data: userProfile, error } = await supabase
      .from('profiles')
      .select(`
        *,
        organizations (
          name,
          tax_code,
          address,
          phone_number,
          status
        )
      `)
      .eq('id', user.id)
      .single();
    
    // user.email sáº½ cÃ³ email
    // userProfile sáº½ chá»©a toÃ n bá»™ thÃ´ng tin cÃ²n láº¡i
    ```
    

Báº±ng cÃ¡ch tÃ¡i cáº¥u trÃºc theo mÃ´ hÃ¬nh nÃ y, trang quáº£n lÃ½ tÃ i khoáº£n cá»§a báº¡n sáº½ trá»Ÿ nÃªn cá»±c ká»³ chuyÃªn nghiá»‡p, logic vÃ  cung cáº¥p Ä‘áº§y Ä‘á»§ thÃ´ng tin cho ngÆ°á»i dÃ¹ng má»™t cÃ¡ch trá»±c quan.